"use strict";$(function(){function e(e){this.ele=document.getElementsByClassName(e),this.Q_checkboxs=document.getElementsByName("ckb1"),this.checkboxs=document.getElementsByName("ckb2"),this.contents=document.getElementsByClassName("man1_con"),this.foot=document.getElementById("bottomToolbar"),this.inputs=document.getElementsByClassName("p-quantity"),this.subtotals=document.getElementsByClassName("subtotal"),this.Adds=document.getElementsByClassName("addCart_c"),this.init()}e.prototype.total=function(){for(var e=0,t=0;t<this.checkboxs.length;t++)if(this.checkboxs[t].checked){var n=this.checkboxs[t].parentNode.parentNode.children[5].lastElementChild.lastElementChild.innerHTML;e+=parseFloat(n)}$("#Total").html(e.toFixed(2))},e.prototype.subtotal=function(){for(var e=0;e<this.subtotals.length;e++){var t=parseInt(this.subtotals[e].parentNode.parentNode.previousElementSibling.firstElementChild.children[1].value),n=parseFloat(this.subtotals[e].parentNode.parentNode.previousElementSibling.previousElementSibling.firstElementChild.lastElementChild.innerHTML);this.subtotals[e].innerHTML=(t*n).toFixed(2)}},e.prototype.onInput=function(){for(var n=this,e=function(t){n.inputs[t].oninput=function(){var e=parseInt(n.inputs[t].value);n.inputs[t].value=1<e?e:1}},t=0;t<n.inputs.length;t++)e(t)},$(".del_smallbox").click(function(){$(".del_box").css({display:"none"})}),e.prototype.Sum=function(){for(var e=0,t=0;t<this.checkboxs.length;t++)this.checkboxs[t].checked&&(e+=parseInt(this.checkboxs[t].parentNode.parentNode.children[4].firstElementChild.children[1].value));$("#Sum").html(e)},e.prototype.bindClick=function(){var v=this;document.body.onclick=function(e){for(var t=(e=e||window.event).target||e.srcElement,n=0;n<v.Q_checkboxs.length;n++)if(t==v.Q_checkboxs[n])if(v.Q_checkboxs[n].checked){for(var c=0;c<v.Q_checkboxs.length;c++)v.Q_checkboxs[c].checked=!0;for(var o=0;o<v.checkboxs.length;o++)v.checkboxs[o].checked=!0}else{for(var s=0;s<v.Q_checkboxs.length;s++)v.Q_checkboxs[s].checked=!1;for(var l=0;l<v.checkboxs.length;l++)v.checkboxs[l].checked=!1}for(var i=0,a=0;a<v.checkboxs.length;a++)if(v.checkboxs[a].checked&&i++,i==v.checkboxs.length)for(var r=0;r<v.Q_checkboxs.length;r++)v.Q_checkboxs[r].checked=!0;else for(var d=0;d<v.Q_checkboxs.length;d++)v.Q_checkboxs[d].checked=!1;if("-"==t.value){var h=t.nextElementSibling.value;--h<1&&(h=1),t.nextElementSibling.value=h}if("+"==t.value){h=t.previousElementSibling.value;h++,t.previousElementSibling.value=h}if("main1_del"==t.name&&(t.nextElementSibling.style.display="block"),"del_box1"==t.name&&t.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.remove(),"Deleteall"==t.name){for(var p=0,b=0;b<v.checkboxs.length;b++)v.checkboxs[b].checked&&p++;if(1<=p){if(confirm("确认删除？"))for(var m=v.checkboxs.length-1;0<=m;m--)v.checkboxs[m].checked&&v.checkboxs[m].parentNode.parentNode.parentNode.remove()}else confirm("您还没选中商品！")}if(v.checkboxs.length<1)for(var u=0;u<v.Q_checkboxs.length;u++)v.Q_checkboxs[u].checked=!1;if("btnDisBlock"==t.name){var k=$("#Total").html();if(0<k)if(confirm("你确定购买这些商品吗")){alert("已支付"+k+"元");for(var f=v.checkboxs.length-1;0<=f;f--)v.checkboxs[f].checked&&v.checkboxs[f].parentNode.parentNode.parentNode.remove()}else alert("您已放弃支付");else alert("您还没选中商品")}}},e.prototype.docOnclick=function(){var t=this;document.onclick=function(){if(t.subtotal(),t.total(),t.Sum(),t.onInput(),t.checkboxs.length<1){for(var e=0;e<t.Q_checkboxs.length;e++)t.Q_checkboxs[e].checked=!1;$(".biaotou").css({display:"none"}),$("#bottomToolbar").css({display:"none"}),$(".content_list").css({display:"none"}),$("#empty_cart").css({display:"block"})}else $("#empty_cart").css({display:"none"})}},e.prototype.addSomething=function(){for(var r=this,e=function(a){r.Adds[a].onclick=function(){$(".biaotou").css({display:"block"}),$("#bottomToolbar").css({display:"block"}),$(".content_list").css({display:"block"}),$("#empty_cart").css({display:"none"});for(var e=r.Adds[a].getAttribute("code"),t=r.Adds[a].nextElementSibling.getAttribute("src"),n=r.Adds[a].parentNode.parentNode.nextElementSibling.firstElementChild.innerHTML,c=r.Adds[a].parentNode.parentNode.nextElementSibling.getAttribute("price"),o=0,s='<div class="man1_con">\n                    <ul class="listBox">\n                    <li class="pad_t20">\n                        <input type="checkbox" class="ckb2" checked="true" name="ckb2" value="'.concat(e,'">\n                    </li>\n                    <li class="man1_pro">\n                        <img style="line-height:1.5;word-break:break-all " class="wid_80 hei_80 border-4" src="').concat(t,'">\n                    </li>\n                    <li class="man1_n" style="vertical-align: middle;">\n                        <p class="man1_name">\n                            <a href="javascript:void(0)">').concat(n,'</a>\n                            <br>\n                        </p>\n                        <div style="width: 180px; white-space:nowrap; overflow: hidden; text-overflow: ellipsis;">\n                            <a href="javascript:void(0)"></a>\n                            <br>\n                        </div>\n                    </li>\n                    <li class="man1_p_m price_font">\n                        <div class="price_font"> ¥<em>').concat(c,'</em>\n                        </div>\n                    </li>\n                    <li class="man1_p_m" style="width:120px;">\n                        <div>\n                            <button style="cursor: pointer" class="fl min-quantity  disabled  " type="button" value="-" disabled="">-</button>\n                            <input class="fl p-quantity " name="quantity" type="text" value="1">\n                            <button style="cursor: pointer" class="maxquantity fl min-quantity " value="+" type="button">+</button>\n                        </div>\n                        <div class="stock_box">\n                            库存:<span class="proAllQty">有货</span>\n                        </div>\n                    </li>\n                    <li class="man1_p_m price_font" style="width: 120px;">\n                        <strong>¥<em class="subtotal">').concat(c,'</em></strong>\n                    </li>\n                    <li class="main1_del" name="main1_del" style="width: 100px;">\n                        <a href="javascript:void(0);">【删除】</a>\n                        <div class="del_box">\n                            <em name="del_smallbox" class="demo-icons fa-times-circle font_16 fr" href="javascript:;" style="cursor: pointer;">x</em>\n                            <p>确认删除？</p>\n                            <ul>\n                                <li class="del_box_c font_ff">\n                                    <a href="javascript:void(0);">移入收藏</a>\n                                </li>\n                                <li class="del_box_t font_ff" name="del_box">\n                                    <a href="javascript:void(0);">确定删除</a>\n                                </li>\n                            </ul>\n                        </div>\n                    </li>\n                </ul>\n            </div>'),l=0;l<$(".ckb2").length;l++){if($(".ckb2").eq(l).attr("value")==e){var i=parseInt($(".p-quantity").eq(l).attr("value"));return i++,$(".p-quantity").eq(l).attr({value:i}),void(r.checkboxs[l].checked=!0)}if(++o==$(".ckb2").length)return void $(".content_list").append(s)}$(".ckb2").length<1&&$(".content_list").append(s)}},t=0;t<r.Adds.length;t++)e(t)},e.prototype.init=function(){this.onInput(),this.bindClick(),this.addSomething(),this.docOnclick()},new e("wid")});